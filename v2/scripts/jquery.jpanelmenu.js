(function(a){a.jPanelMenu=function(c){(typeof c=="undefined"||c==null)&&(c={});var b={options:a.extend({menu:'#menu',panel:'body',trigger:'.menu-trigger',excludedPanelContent:'style, script, .viewer',clone:!0,keepEventHandlers:!1,direction:'left',openPosition:'250px',animated:!1,closeOnContentClick:!1,keyboardShortcuts:[{code:27,open:!1,close:!0},{code:37,open:!1,close:!0},{code:39,open:!0,close:!0},{code:77,open:!0,close:!0}],duration:150,openDuration:c.duration||150,closeDuration:c.duration||150,easing:'ease-in-out',openEasing:c.easing||'ease-in-out',closeEasing:c.easing||'ease-in-out',before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},c),settings:{transitionsSupported:'WebkitTransition'in document.body.style||'MozTransition'in document.body.style||'msTransition'in document.body.style||'OTransition'in document.body.style||'Transition'in document.body.style,transformsSupported:'WebkitTransform'in document.body.style||'MozTransform'in document.body.style||'msTransform'in document.body.style||'OTransform'in document.body.style||'Transform'in document.body.style,cssPrefix:'',panelPosition:'static',positionUnits:'px'},menu:'#jPanelMenu-menu',panel:'.jPanelMenu-panel',timeouts:{},clearTimeouts:function(){clearTimeout(b.timeouts.open),clearTimeout(b.timeouts.afterOpen),clearTimeout(b.timeouts.afterClose)},setPositionUnits:function(){for(var d=!1,e=['%','px','em'],a=0,c;a<e.length;a++)c=e[a],b.options.openPosition.toString().substr(-c.length)==c&&(d=!0,b.settings.positionUnits=c);d||(b.options.openPosition=parseInt(b.options.openPosition)+b.settings.positionUnits)},computePositionStyle:function(g,f){var e=g?b.options.openPosition:'0'+b.settings.positionUnits,a={},h,d,c;return b.settings.transformsSupported?(h=g&&b.options.direction=='right'?'-':'',d='translate3d('+h+e+',0,0)',c='transform',f?(a='',b.settings.cssPrefix!=''&&(a=b.settings.cssPrefix+c+':'+d+';'),a+=c+':'+d+';'):(b.settings.cssPrefix!=''&&(a[b.settings.cssPrefix+c]=d),a[c]=d)):f?(a='',a=b.options.direction+': '+e+';'):a[b.options.direction]=e,a},setCSSPrefix:function(){b.settings.cssPrefix=b.getCSSPrefix()},setjPanelMenuStyles:function(){var c='background:#fff',d=a('html').css('background-color'),e=a('body').css('background-color'),f=function(b){var c=[];return a.each(['background-color','background-image','background-position','background-repeat','background-attachment','background-size','background-clip'],function(d,a){b.css(a)!==''&&c.push(a+':'+b.css(a))}),c.join(';')};e!=='transparent'&&e!=="rgba(0, 0, 0, 0)"?c=f(a('body')):d!=='transparent'&&d!=="rgba(0, 0, 0, 0)"&&(c=f(a('html'))),a('#jPanelMenu-style-master').length==0&&a('body').append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+b.options.direction+':0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;'+b.options.direction+':0;top:0;z-index:2;width:100%;min-height:100%;'+c+';}</style>')},setMenuState:function(c){var d=c?'open':'closed';a(b.options.panel).attr('data-menu-position',d)},getMenuState:function(){return a(b.options.panel).attr('data-menu-position')},menuIsOpen:function(){return b.getMenuState()=='open'},setMenuStyle:function(c){a(b.menu).css(c)},setPanelStyle:function(c){a(b.panel).css(c)},showMenu:function(){b.setMenuStyle({display:'block'}),b.setMenuStyle({'z-index':'1'})},hideMenu:function(){b.setMenuStyle({'z-index':'-1'}),b.setMenuStyle({display:'none'})},enableTransitions:function(e,f){var c=e/1e3,d=b.getCSSEasingFunction(f);b.disableTransitions(),a('body').append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{'+b.settings.cssPrefix+'transition: all '+c+'s '+d+'; transition: all '+c+'s '+d+';}</style>')},disableTransitions:function(){a('#jPanelMenu-style-transitions').remove()},getCSSEasingFunction:function(a){switch(a){case'linear':return a;break;case'ease':return a;break;case'ease-in':return a;break;case'ease-out':return a;break;case'ease-in-out':return a;break;default:return'ease-in-out';break}},getJSEasingFunction:function(a){switch(a){case'linear':return a;break;default:return'swing';break}},getVendorPrefix:function(){var b,a,c;if('result'in arguments.callee)return arguments.callee.result;b=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,a=document.getElementsByTagName('script')[0];for(c in a.style)if(b.test(c))return arguments.callee.result=c.match(b)[0];return'WebkitOpacity'in a.style?arguments.callee.result='Webkit':'KhtmlOpacity'in a.style?arguments.callee.result='Khtml':arguments.callee.result=''},getCSSPrefix:function(){var a=b.getVendorPrefix();return a!=''?'-'+a.toLowerCase()+'-':''},openMenu:function(c){var d,f,g,e;(typeof c=="undefined"||c==null)&&(c=b.options.animated),b.clearTimeouts(),b.options.before(),b.options.beforeOpen(),b.setMenuState(!0),b.showMenu(),d={none:!c,transitions:!!(c&&b.settings.transitionsSupported)},d.transitions||d.none?(d.none&&b.disableTransitions(),d.transitions&&b.enableTransitions(b.options.openDuration,b.options.openEasing),f=b.computePositionStyle(!0),b.setPanelStyle(f),b.timeouts.afterOpen=setTimeout(function(){b.options.after(),b.options.afterOpen(),b.initiateContentClickListeners()},b.options.openDuration)):(g=b.getJSEasingFunction(b.options.openEasing),e={},e[b.options.direction]=b.options.openPosition,a(b.panel).stop().animate(e,b.options.openDuration,g,function(){b.options.after(),b.options.afterOpen(),b.initiateContentClickListeners()}))},closeMenu:function(c){var d,f,g,e;(typeof c=="undefined"||c==null)&&(c=b.options.animated),b.clearTimeouts(),b.options.before(),b.options.beforeClose(),b.setMenuState(!1),d={none:!c,transitions:!!(c&&b.settings.transitionsSupported)},d.transitions||d.none?(d.none&&b.disableTransitions(),d.transitions&&b.enableTransitions(b.options.closeDuration,b.options.closeEasing),f=b.computePositionStyle(),b.setPanelStyle(f),b.timeouts.afterClose=setTimeout(function(){b.disableTransitions(),b.hideMenu(),b.options.after(),b.options.afterClose(),b.destroyContentClickListeners()},b.options.closeDuration)):(g=b.getJSEasingFunction(b.options.closeEasing),e={},e[b.options.direction]=0+b.settings.positionUnits,a(b.panel).stop().animate(e,b.options.closeDuration,g,function(){b.hideMenu(),b.options.after(),b.options.afterClose(),b.destroyContentClickListeners()}))},triggerMenu:function(a){b.menuIsOpen()?b.closeMenu(a):b.openMenu(a)},initiateClickListeners:function(){a(document).on('click touchend',b.options.trigger,function(a){b.triggerMenu(b.options.animated),a.preventDefault()})},destroyClickListeners:function(){a(document).off('click touchend',b.options.trigger,null)},initiateContentClickListeners:function(){if(!b.options.closeOnContentClick)return!1;a(document).on('click touchend',b.panel,function(a){b.menuIsOpen()&&b.closeMenu(b.options.animated),a.preventDefault()})},destroyContentClickListeners:function(){if(!b.options.closeOnContentClick)return!1;a(document).off('click touchend',b.panel,null)},initiateKeyboardListeners:function(){var c=['input','textarea','select'];a(document).on('keydown',function(e){var g=a(e.target),f=!1,d;if(a.each(c,function(){g.is(this.toString())&&(f=!0)}),f)return!0;for(mapping in b.options.keyboardShortcuts)e.which==b.options.keyboardShortcuts[mapping].code&&(d=b.options.keyboardShortcuts[mapping],d.open&&d.close?b.triggerMenu(b.options.animated):d.open&&!d.close&&!b.menuIsOpen()?b.openMenu(b.options.animated):!d.open&&d.close&&b.menuIsOpen()&&b.closeMenu(b.options.animated),e.preventDefault())})},destroyKeyboardListeners:function(){a(document).off('keydown',null)},setupMarkup:function(){a('html').addClass('jPanelMenu'),a(b.options.panel+' > *').not(b.menu+', '+b.options.excludedPanelContent).wrapAll('<div class="'+b.panel.replace('.','')+'"/>');var c=b.options.clone?a(b.options.menu).clone(b.options.keepEventHandlers):a(b.options.menu);c.attr('id',b.menu.replace('#','')).insertAfter(b.options.panel+' > '+b.panel)},resetMarkup:function(){a('html').removeClass('jPanelMenu'),a(b.options.panel+' > '+b.panel+' > *').unwrap(),a(b.menu).remove()},init:function(){b.options.beforeOn(),b.setPositionUnits(),b.setCSSPrefix(),b.initiateClickListeners(),Object.prototype.toString.call(b.options.keyboardShortcuts)==='[object Array]'&&b.initiateKeyboardListeners(),b.setjPanelMenuStyles(),b.setMenuState(!1),b.setupMarkup(),b.setPanelStyle({position:b.options.animated&&b.settings.panelPosition==='static'?'relative':b.settings.panelPosition}),b.setMenuStyle({width:b.options.openPosition}),b.closeMenu(!1),b.options.afterOn()},destroy:function(){b.options.beforeOff(),b.closeMenu(),b.destroyClickListeners(),Object.prototype.toString.call(b.options.keyboardShortcuts)==='[object Array]'&&b.destroyKeyboardListeners(),b.resetMarkup();var a={};a[b.options.direction]='auto',b.options.afterOff()}};return{on:b.init,off:b.destroy,trigger:b.triggerMenu,open:b.openMenu,close:b.closeMenu,isOpen:b.menuIsOpen,menu:b.menu,getMenu:function(){return a(b.menu)},panel:b.panel,getPanel:function(){return a(b.panel)},setPosition:function(a){(typeof a=="undefined"||a==null)&&(a=b.options.openPosition),b.options.openPosition=a,b.setMenuStyle({width:b.options.openPosition})}}}})(jQuery)