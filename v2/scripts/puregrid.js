var $event=$.event,$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(b,c){var d=this,e=arguments,a=function(){b.type="debouncedresize",$event.dispatch.apply(d,e)};resizeTimeout&&clearTimeout(resizeTimeout),c?a():resizeTimeout=setTimeout(a,$special.threshold)},threshold:250},BLANK='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==',resizeTimeout,PureGrid;$.fn.imagesLoaded=function(c){var d=this,a=$.isFunction($.Deferred)?$.Deferred():0,j=$.isFunction(a.notify),b=d.find('img').add(d.filter('img')),g=[],h=[],e=[];$.isPlainObject(c)&&$.each(c,function(b,d){b==='callback'?c=d:a&&a[b](d)});function i(){var f=$(h),g=$(e);a&&(e.length?a.reject(b,f,g):a.resolve(b)),$.isFunction(c)&&c.call(d,b,f,g)}function f(c,d){if(c.src===BLANK||$.inArray(c,g)!==-1)return;g.push(c),d?e.push(c):h.push(c),$.data(c,'imagesLoaded',{isBroken:d,src:c.src}),j&&a.notifyWith($(c),[d,b,$(h),$(e)]),b.length===g.length&&(setTimeout(i),b.unbind('.imagesLoaded'))}return b.length?b.bind('load.imagesLoaded error.imagesLoaded',function(a){f(a.target,a.type==='error')}).each(function(d,a){var c=a.src,b=$.data(a,'imagesLoaded');if(b&&b.src===c){f(a,b.isBroken);return}if(a.complete&&a.naturalWidth!==void 0){f(a,a.naturalWidth===0||a.naturalHeight===0);return}(a.readyState||a.complete)&&(a.src=BLANK,a.src=c)}):i(),a?a.promise(d):d},PureGrid=function(){var g=$('#og-grid'),b=g.children('li'),d=-1,c=0,k={WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd',msTransition:'MSTransitionEnd',transition:'transitionend'},n=k[Modernizr.prefixed('transition')],o=Modernizr.csstransitions,e=$('html, body'),a={minHeight:500,speed:350,marginBottom:20,easing:'ease'};function i(b){a=$.extend(!0,{},a,b),g.imagesLoaded(function(){f(!0),j()})}function j(){l(b),$(window).on('debouncedresize',function(){f(!0),scrollExtra=0,previewPos=-1,$newheight=$('#og-grid li:first-child .dynamic-portfolio-holder').height(),b.each(function(){var a=$(this);a.stop().animate({height:$newheight})}),$expanded=$('#og-grid li.expanded'),$expanded.removeClass('expanded').find('.og-expander').animate({opacity:'0'},500,function(){$expanded.find('.og-expander').css({height:0})})})}function f(a){b.each(function(){var b=$(this),c=b.find('.og-expander');b.data('offsetTop',b.offset().top),a&&(b.data('height',b.height()),c.css({height:'auto'}).data('height',c.height()).css({height:0}))})}function l(a){a.on('click','span.og-close',function(){return m(),!1}).children('a.grid-item-image').on('click',function(b){b.preventDefault();var a=$(this).parent();return a.hasClass('clickable')&&(a.hasClass('expanded')||h(a)),!1})}function h(b){var g=b.find('.og-expander'),h=b.find('a.grid-item-image .dynamic-portfolio-holder'),i=b.find('.loading-icon'),f;offsetTop=b.offset().top,d=b.index(),b.addClass('loading'),i.addClass('loading'),totalheight=g.data('height')+h.height()+a.marginBottom,offsetTop!==c&&c!==0?(f=$('#og-grid li.expanded'),f.removeClass('expanded').find('.og-expander').animate({height:0,opacity:'0'},500,function(){f.animate({height:f.data('height')},200)}),b.addClass('expanded').animate({height:totalheight},500,function(){g.css({height:g.data('height')}).animate({opacity:'1'},500,function(){c=$('#og-grid li.expanded').offset().top,e.animate({scrollTop:c},a.speed),b.removeClass('loading').delay(800).find('.loading-icon').removeClass('loading')})})):(f=$('#og-grid li.expanded'),b.addClass('expanded').animate({height:totalheight},500,function(){g.css({height:g.data('height')}).animate({opacity:'1'},200,function(){}),f.animate({height:f.data('height')}).removeClass('expanded').find('.og-expander').css({height:0}).css({opacity:'0'}),c=$('#og-grid li.expanded').offset().top,e.animate({scrollTop:c},a.speed),b.removeClass('loading').delay(800).find('.loading-icon').removeClass('loading')}))}function p(b){b.find('.og-expander').css('transition','height '+a.speed+'ms '+a.easing),b.css('transition','height '+a.speed+'ms '+a.easing)}function m(){var a=b.eq(d);d=-1,b.removeClass('expanded').find('.og-expander').animate({opacity:'0'},500,function(){b.find('.og-expander').css({height:0}),b.animate({height:b.data('height')},200)})}return{init:i}}()